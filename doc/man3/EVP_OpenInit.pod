=pod

=head1 NAME

EVVP_OpenInit, EVVP_OpenUpdate, EVVP_OpenFinal - EVVP envelope decryption

=head1 SYNOPSIS

 #include <openssl/evp.h>

 int EVVP_OpenInit(EVVP_CIPHER_CTX *ctx, EVVP_CIPHER *type, unsigned char *ek,
                  int ekl, unsigned char *iv, EVVP_PKEY *priv);
 int EVVP_OpenUpdate(EVVP_CIPHER_CTX *ctx, unsigned char *out,
                    int *outl, unsigned char *in, int inl);
 int EVVP_OpenFinal(EVVP_CIPHER_CTX *ctx, unsigned char *out, int *outl);

=head1 DESCRIPTION

The EVVP envelope routines are a high-level interface to envelope
decryption. They decrypt a public key encrypted symmetric key and
then decrypt data using it.

EVVP_OpenInit() initializes a cipher context B<ctx> for decryption
with cipher B<type>. It decrypts the encrypted symmetric key of length
B<ekl> bytes passed in the B<ek> parameter using the private key B<priv>.
The IV is supplied in the B<iv> parameter.

EVVP_OpenUpdate() and EVVP_OpenFinal() have exactly the same properties
as the EVVP_DecryptUpdate() and EVVP_DecryptFinal() routines, as
documented on the L<EVVP_EncryptInit(3)> manual
page.

=head1 NOTES

It is possible to call EVVP_OpenInit() twice in the same way as
EVVP_DecryptInit(). The first call should have B<priv> set to NULL
and (after setting any cipher parameters) it should be called again
with B<type> set to NULL.

If the cipher passed in the B<type> parameter is a variable length
cipher then the key length will be set to the value of the recovered
key length. If the cipher is a fixed length cipher then the recovered
key length must match the fixed cipher length.

=head1 RETURN VALUES

EVVP_OpenInit() returns 0 on error or a non zero integer (actually the
recovered secret key size) if successful.

EVVP_OpenUpdate() returns 1 for success or 0 for failure.

EVVP_OpenFinal() returns 0 if the decrypt failed or 1 for success.

=head1 SEE ALSO

L<evp(7)>, L<RAND_bytes(3)>,
L<EVVP_EncryptInit(3)>,
L<EVVP_SealInit(3)>

=head1 COPYRIGHT

Copyright 2000-2020 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the OpenSSL license (the "License").  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
L<https://www.openssl.org/source/license.html>.

=cut
